<!-- Juice Project - Est. 2016 | Last updated 2025 -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <meta name="created" content="2016-03-14">
  <meta name="author" content="Juice Project">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta property="og:type" content="website">
  <meta property="og:site_name" content="The Juice Box">
  <meta property="og:image" content="https://thejuicebox.live/og-image.png">
  <meta property="og:image:type" content="image/png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://thejuicebox.live/og-image.png">
  <meta property="og:title" content="Person Details">
  <meta property="og:description" content="Comprehensive directory of religious organizations worldwide - tracking structure, people, and connections since 2016.">
  <meta property="og:url" content="https://thejuicebox.live/person.html">
  <meta name="twitter:title" content="Person Details">
  <meta name="twitter:description" content="Comprehensive directory of religious organizations worldwide - tracking structure, people, and connections since 2016.">
  <title>Person Details</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; color: #000; background: #fff; }
    h1 { color: #000; }
    h2 { margin-top: 15px; margin-bottom: 8px; }
nav { overflow-x: auto; -webkit-overflow-scrolling: touch; }
    nav ul { list-style: none; margin: 0; padding: 10px 15px; display: flex; flex-wrap: wrap; gap: 8px; justify-content: center; align-items: center; }
    nav ul li { margin: 0; white-space: nowrap; }
    nav a { color: #0000EE !important; text-decoration: none; background: rgba(255,255,255,0.85); padding: 5px 12px; white-space: nowrap; border-radius: 6px; border: 1px solid rgba(0,0,255,0.3); box-shadow: 1px 1px 2px rgba(0,0,0,0.2); font-size: 0.82em; display: inline-block; line-height: 1.4; }
    nav select { padding: 6px 10px; border-radius: 6px; border: 1px solid rgba(0,0,255,0.3); font-size: 0.85em; background: rgba(255,255,255,0.85); }
    .panel { background: rgba(255,255,255,0.85); border: 1px solid rgba(0,0,255,0.3); border-radius: 6px; padding: 10px; margin: 5px 0; color: #000; text-shadow: 1px 1px 2px rgba(0,0,0,0.2); }
    .panel a { color: #0000EE; }
    .back-link { font-weight: bold; text-decoration: none; color: #0000EE; }
    .person-header { font-size: 1.8em; margin: 0; }
    .affiliation-card { margin: 8px 0; padding: 10px; background: rgba(240,240,255,0.7); border-radius: 6px; border: 1px solid rgba(0,0,255,0.15); }
    .affiliation-card a { font-weight: bold; color: #0000EE; font-size: 1.05em; }
    .co-person { display: inline-block; margin: 3px 2px; }
    .co-person a { color: #0000EE; font-size: 0.95em; }
  
    /* Glassmorphism panels */
    .panel, .cat-card, .featured-card, .discover-card, .kpi-card, .chart-card,
    .export-card, .result-card, .person-card, .connection-item, .similar-card,
    .bm-card, .comp-card, .entry-card, .country-card, .stat-box, .controls,
    .search-section, .shared-section, .endpoint {
      background: rgba(255, 255, 255, 0.15) !important;
      backdrop-filter: blur(12px) !important;
      -webkit-backdrop-filter: blur(12px) !important;
      border: 1px solid rgba(255, 255, 255, 0.25) !important;
      border-radius: 12px !important;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08) !important;
    }
    .panel:hover, .cat-card:hover, .featured-card:hover, .discover-card:hover,
    .kpi-card:hover, .chart-card:hover, .result-card:hover, .person-card:hover,
    .connection-item:hover, .similar-card:hover, .bm-card:hover, .entry-card:hover,
    .country-card:hover {
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.15) !important;
      border-color: rgba(255, 255, 255, 0.35) !important;
    }
    nav a {
      background: rgba(255, 255, 255, 0.2) !important;
      backdrop-filter: blur(8px) !important;
      -webkit-backdrop-filter: blur(8px) !important;
      border: 1px solid rgba(255, 255, 255, 0.3) !important;
      border-radius: 8px !important;
    }
    nav select {
      background: rgba(255, 255, 255, 0.2) !important;
      backdrop-filter: blur(8px) !important;
      -webkit-backdrop-filter: blur(8px) !important;
      border: 1px solid rgba(255, 255, 255, 0.3) !important;
    }
    .quick-search input {
      background: rgba(255, 255, 255, 0.2) !important;
      backdrop-filter: blur(8px) !important;
      -webkit-backdrop-filter: blur(8px) !important;
      border: 1px solid rgba(255, 255, 255, 0.3) !important;
    }
    .discover-btn, .btn, .btn-find, .btn-primary {
      backdrop-filter: blur(8px) !important;
      -webkit-backdrop-filter: blur(8px) !important;
    }
    .tag {
      background: rgba(0, 123, 255, 0.1) !important;
      backdrop-filter: blur(4px) !important;
      -webkit-backdrop-filter: blur(4px) !important;
      border: 1px solid rgba(0, 123, 255, 0.15) !important;
    }
    .country-item {
      background: rgba(255, 255, 255, 0.12) !important;
      backdrop-filter: blur(8px) !important;
      -webkit-backdrop-filter: blur(8px) !important;
      border: 1px solid rgba(255, 255, 255, 0.2) !important;
      border-radius: 8px !important;
    }
    /* Glassmorphism dark mode overrides */
    body.dark-mode .panel, body.dark-mode .cat-card, body.dark-mode .featured-card,
    body.dark-mode .discover-card, body.dark-mode .kpi-card, body.dark-mode .chart-card,
    body.dark-mode .export-card, body.dark-mode .result-card, body.dark-mode .person-card,
    body.dark-mode .connection-item, body.dark-mode .similar-card, body.dark-mode .bm-card,
    body.dark-mode .comp-card, body.dark-mode .entry-card, body.dark-mode .country-card,
    body.dark-mode .stat-box, body.dark-mode .controls, body.dark-mode .search-section,
    body.dark-mode .shared-section, body.dark-mode .endpoint, body.dark-mode .legend {
      background: rgba(20, 20, 40, 0.45) !important;
      backdrop-filter: blur(12px) !important;
      -webkit-backdrop-filter: blur(12px) !important;
      border: 1px solid rgba(100, 100, 255, 0.15) !important;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.25) !important;
    }
    body.dark-mode nav a {
      background: rgba(20, 20, 50, 0.4) !important;
      backdrop-filter: blur(8px) !important;
      -webkit-backdrop-filter: blur(8px) !important;
      border: 1px solid rgba(100, 100, 255, 0.2) !important;
    }
    body.dark-mode nav select {
      background: rgba(20, 20, 50, 0.4) !important;
      backdrop-filter: blur(8px) !important;
      -webkit-backdrop-filter: blur(8px) !important;
    }
    body.dark-mode .country-item {
      background: rgba(30, 30, 60, 0.4) !important;
      backdrop-filter: blur(8px) !important;
      -webkit-backdrop-filter: blur(8px) !important;
      border: 1px solid rgba(100, 100, 255, 0.15) !important;
    }
    body.dark-mode .tag {
      background: rgba(60, 100, 200, 0.15) !important;
      border: 1px solid rgba(100, 100, 255, 0.2) !important;
    }

  </style>
</head>
<body>
  <nav id="navbar"></nav>
  <div class="panel"><a href="index.html" class="back-link">&#8592; Back to full list</a></div>
  <div class="panel">
    <h1 class="person-header" id="person-name">Loading...</h1>
  </div>
  <div class="panel" id="person-bio-panel">
    <h2>Biography</h2>
    <p id="person-bio" style="line-height:1.6"></p>
  </div>
  <div class="panel">
    <h2>Affiliations</h2>
    <div id="affiliations-list"></div>
  </div>

  <script src="app.js"></script>
  <script>
    function slugify(str) {
      return str.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/^-|-$/g, '');
    }
    const id = new URLSearchParams(window.location.search).get('id');
    const religion = new URLSearchParams(window.location.search).get('religion') || 'jewish';
    initPage(religion);
    if (!id) {
      document.body.textContent = 'Person id missing';
    } else {
      fetch('/api/person/' + encodeURIComponent(id))
        .then(r => r.ok ? r.json() : Promise.reject('Not found'))
        .then(person => {
          document.title = person.name + ' - Person Details';
          document.getElementById('person-name').textContent = person.name;

          // Bookmark button
          const bmBtn = document.createElement('button');
          bmBtn.style.cssText = 'margin-left:12px;padding:5px 14px;border-radius:16px;border:1px solid rgba(0,0,255,0.3);cursor:pointer;font-size:0.85em;vertical-align:middle;';
          function updateBmBtn() {
            const saved = BookmarkManager.isPersonBookmarked(id);
            bmBtn.innerHTML = saved ? '<i class="fa-solid fa-bookmark"></i> Bookmarked' : '<i class="fa-regular fa-bookmark"></i> Bookmark';
            bmBtn.style.background = saved ? 'rgba(255,193,7,0.2)' : 'rgba(0,123,255,0.1)';
            bmBtn.style.color = saved ? '#b8860b' : '#0056b3';
          }
          updateBmBtn();
          bmBtn.addEventListener('click', () => {
            if (BookmarkManager.isPersonBookmarked(id)) { BookmarkManager.removePerson(id); }
            else { BookmarkManager.addPerson({ id, name: person.name, bio: (person.bio || '').substring(0, 200) }); }
            updateBmBtn();
          });
          document.getElementById('person-name').appendChild(bmBtn);

          document.getElementById('person-bio').textContent = person.bio || 'No biography available.';
          const list = document.getElementById('affiliations-list');
          if (person.affiliations && person.affiliations.length) {
            person.affiliations.forEach(a => {
              const card = document.createElement('div');
              card.className = 'affiliation-card';
              const orgLink = document.createElement('a');
              orgLink.href = 'entry.html?religion=' + encodeURIComponent(a.religion) + '&id=' + encodeURIComponent(a.entryId || slugify(a.organization));
              orgLink.textContent = a.organization;
              card.appendChild(orgLink);
              card.appendChild(document.createTextNode(' - ' + (a.role || '') + ' - '));
              const countryLink = document.createElement('a');
              countryLink.href = 'country.html?religion=' + encodeURIComponent(a.religion) + '&country=' + encodeURIComponent(a.country);
              countryLink.textContent = a.country;
              countryLink.style.fontWeight = 'normal';
              card.appendChild(countryLink);
              // Co-individuals
              if (a.coIndividuals && a.coIndividuals.length) {
                const coDiv = document.createElement('div');
                coDiv.style.marginTop = '6px';
                coDiv.appendChild(document.createTextNode('Also at this org: '));
                a.coIndividuals.forEach((co, i) => {
                  const span = document.createElement('span');
                  span.className = 'co-person';
                  const coLink = document.createElement('a');
                  coLink.href = 'person.html?id=' + encodeURIComponent(co.id);
                  coLink.textContent = co.name;
                  span.appendChild(coLink);
                  if (i < a.coIndividuals.length - 1) span.appendChild(document.createTextNode(', '));
                  coDiv.appendChild(span);
                });
                card.appendChild(coDiv);
              }
              list.appendChild(card);
            });
          } else {
            list.textContent = 'No affiliations found.';
          }
        })
        .catch(err => {
          document.getElementById('person-name').textContent = String(err);
        });
    }
  </script>
</body>
</html>